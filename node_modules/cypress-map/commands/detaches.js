/// <reference types="cypress" />
// @ts-check
var registerQuery = require('./utils').registerQuery;
registerQuery('detaches', function (selectorOrAlias) {
    if (typeof selectorOrAlias !== 'string') {
        throw new Error('Selector/alias must be a string');
    }
    var log = Cypress.log({
        name: 'detaches',
        message: String(selectorOrAlias),
    });
    if (selectorOrAlias[0] === '@') {
        return function () {
            var $el = Cypress.env(selectorOrAlias.slice(1));
            if (!$el) {
                throw new Error("Element with alias \"".concat(selectorOrAlias, "\" not found"));
            }
            if (!$el.length) {
                throw new Error("Expected one element, found ".concat($el.length));
            }
            if (Cypress.dom.isAttached($el[0])) {
                throw new Error("Expected element is still attached to the DOM");
            }
        };
    }
    else {
        var el_1 = null;
        return function () {
            if (!el_1) {
                // @ts-expect-error
                var doc = cy.state('document');
                el_1 = doc.querySelector(selectorOrAlias);
            }
            if (!Cypress.dom.isDetached(el_1)) {
                throw new Error("Expected element to be detached");
            }
        };
    }
});
